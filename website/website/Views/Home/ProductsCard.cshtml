@model website.Models.Product

@{
    ViewData["Title"] = "Product Details";
}
<link rel="stylesheet" href="~/css/product-details.css" />

<h1>@Model.Name</h1>

<div class="product-detail">
    <div class="product-detail__photo">
        @if (Model.Images != null && Model.Images.Any())
        {
            foreach (var image in Model.Images)
            {
                <img src="@Url.Content($"~/{image.ImageUrl}")" alt="@Model.Name" style="max-width: 100%; height: auto; margin-bottom: 10px;" />
            }
        }
        else
        {
            <p>No images available for this product.</p>
        }
    </div>
    <div class="product-detail__info">
        <p><strong>Danh mục:</strong> @Model.Category?.Name</p>
        <p><strong>Mô tả:</strong> @Model.Description</p>
        <p><strong>Giá:</strong> @Model.Price.ToString("C")</p>
        <p><strong>Số lượng:</strong> <input type="number" id="quantity" value="1" min="1" class="form-control" /></p>
        <p><strong>Số ngày thuê:</strong> <input type="number" id="rentalDays" value="1" min="1" max="365" class="form-control" /></p>
        <button onclick="addToCart(@Model.ProductId)" class="btn btn-primary">Thêm vào giỏ</button>
    </div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
    function addToCart(productId) {
        var quantity = $('#quantity').val();
        var rentalDays = $('#rentalDays').val();

        $.ajax({
            url: '@Url.Action("AddToCart", "Home")',
            type: 'POST',
            data: {
                productId: productId,
                quantity: quantity,
                rentalDays: rentalDays
            },
            success: function (response) {
                if (response.success) {
                    alert(response.message);
                    // Cập nhật số lượng giỏ hàng trên icon giỏ hàng
                    $('.cart-count').text(response.cartCount);
                } else {
                    alert(response.message);
                }
            },
            error: function () {
                alert('Có lỗi xảy ra, vui lòng thử lại.');
            }
        });
    }
</script>
